---

title: solution


keywords: fastai
sidebar: home_sidebar

summary: "run the physical calculaitons of the model"
description: "run the physical calculaitons of the model"
nb_path: "nbs/03_solution.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/03_solution.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="growing_degree_day" class="doc_header"><code>growing_degree_day</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>growing_degree_day</code>(<strong><code>GDDmethod</code></strong>, <strong><code>Tupp</code></strong>, <strong><code>Tbase</code></strong>, <strong><code>Tmax</code></strong>, <strong><code>Tmin</code></strong>)</p>
</blockquote>
<p>Function to calculate number of growing degree days on current day</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=28" target="_blank">Reference manual: growing degree day calculations</a> (pg. 19-20)</p>
<p><em>Arguments:</em></p>
<p><code>GDDmethod</code>: <code>int</code> : GDD calculation method</p>
<p><code>Tupp</code>: <code>float</code> : Upper temperature (degC) above which crop development no longer increases</p>
<p><code>Tbase</code>: <code>float</code> : Base temperature (degC) below which growth does not progress</p>
<p><code>Tmax</code>: <code>float</code> : Maximum tempature on current day (celcius)</p>
<p><code>Tmin</code>: <code>float</code> : Minimum tempature on current day (celcius)</p>
<p><em>Returns:</em></p>
<p><code>GDD</code>: <code>float</code> : Growing degree days for current day</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="root_zone_water" class="doc_header"><code>root_zone_water</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L82" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>root_zone_water</code>(<strong><code>prof</code></strong>, <strong><code>InitCond_Zroot</code></strong>, <strong><code>InitCond_th</code></strong>, <strong><code>Soil_zTop</code></strong>, <strong><code>Crop_Zmin</code></strong>, <strong><code>Crop_Aer</code></strong>)</p>
</blockquote>
<p>Function to calculate actual and total available water in the rootzone at current time step</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=14" target="_blank">Reference Manual: root-zone water calculations</a> (pg. 5-8)</p>
<p><em>Arguments:</em></p>
<p><code>prof</code>: <a href="/nbdev_qq_test/classes.html#SoilProfileClass"><code>SoilProfileClass</code></a> : jit class Object containing soil paramaters</p>
<p><code>InitCond_Zroot</code>: <code>float</code> : Initial rooting depth</p>
<p><code>InitCond_th</code>: <code>np.array</code> : Initial water content</p>
<p><code>Soil_zTop</code>: <code>float</code> : Top soil depth</p>
<p><code>Crop_Zmin</code>: <code>float</code> : crop minimum rooting depth</p>
<p><code>Crop_Aer</code>: <code>int</code> : number of aeration stress days</p>
<p><em>Returns:</em></p>
<p><code>WrAct</code>: <code>float</code> :  Actual rootzone water content</p>
<p><code>Dr</code>: <a href="/nbdev_qq_test/classes.html#DrClass"><code>DrClass</code></a> :  Depletion objection containing rootzone and topsoil depletion</p>
<p><code>TAW</code>: <a href="/nbdev_qq_test/classes.html#TAWClass"><code>TAWClass</code></a> :  <a href="/nbdev_qq_test/classes.html#TAWClass"><code>TAWClass</code></a> containing rootzone and topsoil total avalable water</p>
<p><code>thRZ</code>: <a href="/nbdev_qq_test/classes.html#thRZClass"><code>thRZClass</code></a> :  thRZ object conaining rootzone water content paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_groundwater_table" class="doc_header"><code>check_groundwater_table</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L223" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_groundwater_table</code>(<strong><code>ClockStruct_TimeStepCounter</code></strong>, <strong><code>prof</code></strong>, <strong><code>NewCond</code></strong>, <strong><code>ParamStruct_WaterTable</code></strong>, <strong><code>zGW</code></strong>)</p>
</blockquote>
<p>Function to check for presence of a groundwater table, and, if present,
to adjust compartment water contents and field capacities where necessary</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=61" target="_blank">Reference manual: water table adjustment equations</a> (pg. 52-57)</p>
<p><em>Arguments:</em></p>
<p><code>ClockStruct</code>: <a href="/nbdev_qq_test/classes.html#ClockStructClass"><code>ClockStructClass</code></a> : ClockStruct object containing clock paramaters</p>
<p><code>Soil</code>: <a href="/nbdev_qq_test/classes.html#SoilClass"><code>SoilClass</code></a> : Soil object containing soil paramaters</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>ParamStruct</code>: <a href="/nbdev_qq_test/classes.html#ParamStructClass"><code>ParamStructClass</code></a> :  model paramaters</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>
<p><code>Soil</code>: <a href="/nbdev_qq_test/classes.html#SoilClass"><code>SoilClass</code></a> : Soil object containing updated soil paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-3b26920cb6ac&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg">#export</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span><span class="ansi-blue-fg">@</span>njit<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> def check_groundwater_table(ClockStruct_TimeStepCounter,prof,NewCond,
<span class="ansi-green-intense-fg ansi-bold">      4</span>                             ParamStruct_WaterTable,ParamStruct_WTMethod,ParamStruct_zGW):
<span class="ansi-green-intense-fg ansi-bold">      5</span>     &#34;&#34;&#34;

<span class="ansi-red-fg">NameError</span>: name &#39;njit&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="root_development" class="doc_header"><code>root_development</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L321" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>root_development</code>(<strong><code>Crop</code></strong>, <strong><code>prof</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>GDD</code></strong>, <strong><code>GrowingSeason</code></strong>, <strong><code>ParamStruct_WaterTable</code></strong>)</p>
</blockquote>
<p>Function to calculate root zone expansion</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=46" target="_blank">Reference Manual: root developement equations</a> (pg. 37-41)</p>
<p><em>Arguments:</em></p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropStruct"><code>CropStruct</code></a> : jit class object containing Crop paramaters</p>
<p><code>prof</code>: <a href="/nbdev_qq_test/classes.html#SoilProfileClass"><code>SoilProfileClass</code></a> : jit class object containing soil paramaters</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>GDD</code>: <code>float</code> : Growing degree days on current day</p>
<p><code>GrowingSeason</code>: <code>bool</code> : is growing season (True or Flase)</p>
<p><code>ParamStruct_WaterTable</code>: <code>int</code> : water table present (True=1 or Flase=0)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pre_irrigation" class="doc_header"><code>pre_irrigation</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L540" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pre_irrigation</code>(<strong><code>prof</code></strong>, <strong><code>Crop</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>GrowingSeason</code></strong>, <strong><code>IrrMngt</code></strong>)</p>
</blockquote>
<p>Function to calculate pre-irrigation when in net irrigation mode</p>
<p><a href="../pdfs/ac_ref_man_1.pdf#page=40" target="_blank">Reference Manual: Net irrigation description</a> (pg. 31)</p>
<p><em>Arguments:</em></p>
<p><code>prof</code>: <a href="/nbdev_qq_test/classes.html#SoilProfileClass"><code>SoilProfileClass</code></a> : Soil object containing soil paramaters</p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropStruct"><code>CropStruct</code></a> : Crop object containing Crop paramaters</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>GrowingSeason</code>: <code>bool</code> : is growing season (True or Flase)</p>
<p><code>IrrMngt</code>: <code>`IrrMngtStruct</code>  object containing irrigation management paramaters</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <code>InitCondClass</code> : InitCond object containing updated model paramaters</p>
<p><code>PreIrr</code>: <code>float</code> : Pre-Irrigaiton applied on current day mm</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="drainage" class="doc_header"><code>drainage</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L610" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>drainage</code>(<strong><code>prof</code></strong>, <strong><code>th_init</code></strong>, <strong><code>th_fc_Adj_init</code></strong>)</p>
</blockquote>
<p>Function to redistribute stored soil water</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=51" target="_blank">Reference Manual: drainage calculations</a> (pg. 42-65)</p>
<p><em>Arguments:</em></p>
<p><code>prof</code>: <a href="/nbdev_qq_test/classes.html#SoilProfileClass"><code>SoilProfileClass</code></a> : jit class object object containing soil paramaters</p>
<p><code>th_init</code>: <code>np.array</code> : initial water content</p>
<p><code>th_fc_Adj_init</code>: <code>np.array</code> : adjusted water content at field capacity</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>
<p><code>DeepPerc</code>:: <code>float</code> : Total Deep Percolation</p>
<p><code>FluxOut</code>:: <code>array-like</code> : Flux of water out of each compartment</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rainfall_partition" class="doc_header"><code>rainfall_partition</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L925" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rainfall_partition</code>(<strong><code>P</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>FieldMngt</code></strong>, <strong><code>Soil_CN</code></strong>, <strong><code>Soil_AdjCN</code></strong>, <strong><code>Soil_zCN</code></strong>, <strong><code>Soil_nComp</code></strong>, <strong><code>prof</code></strong>)</p>
</blockquote>
<p>Function to partition rainfall into surface runoff and infiltration using the curve number approach</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=57" target="_blank">Reference Manual: rainfall partition calculations</a> (pg. 48-51)</p>
<p><em>Arguments:</em></p>
<p><code>P</code>: <code>float</code> : Percipitation on current day</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>FieldMngt</code>: <a href="/nbdev_qq_test/classes.html#FieldMngtStruct"><code>FieldMngtStruct</code></a> : field management params</p>
<p><code>Soil_CN</code>: <code>float</code> : curve number</p>
<p><code>Soil_AdjCN</code>: <code>float</code> : adjusted curve number</p>
<p><code>Soil_zCN</code>: <code>float</code> :</p>
<p><code>Soil_nComp</code>: <code>float</code> : number of compartments</p>
<p><code>prof</code>: <a href="/nbdev_qq_test/classes.html#SoilProfileClass"><code>SoilProfileClass</code></a> : Soil object</p>
<p><em>Returns:</em></p>
<p><code>Runoff</code>: <code>float</code> : Total Suface Runoff</p>
<p><code>Infl</code>: <code>float</code> : Total Infiltration</p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="irrigation" class="doc_header"><code>irrigation</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L1051" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>irrigation</code>(<strong><code>InitCond</code></strong>, <strong><code>IrrMngt</code></strong>, <strong><code>Crop</code></strong>, <strong><code>prof</code></strong>, <strong><code>Soil_zTop</code></strong>, <strong><code>GrowingSeason</code></strong>, <strong><code>Rain</code></strong>, <strong><code>Runoff</code></strong>)</p>
</blockquote>
<p>Function to get irrigation depth for current day</p>
<p><a href="../pdfs/ac_ref_man_1.pdf#page=40" target="_blank">Reference Manual: irrigation description</a> (pg. 31-32)</p>
<p><em>Arguments:</em></p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>IrrMngt</code>: <a href="/nbdev_qq_test/classes.html#IrrMngtStruct"><code>IrrMngtStruct</code></a>: jit class object containing irrigation management paramaters</p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object containing Crop paramaters</p>
<p><code>Soil</code>: <a href="/nbdev_qq_test/classes.html#SoilClass"><code>SoilClass</code></a> : Soil object containing soil paramaters</p>
<p><code>GrowingSeason</code>: <code>bool</code> : is growing season (True or Flase)</p>
<p><code>Rain</code>: <code>float</code> : daily precipitation mm</p>
<p><code>Runoff</code>: <code>float</code> : surface runoff on current day</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>
<p><code>Irr</code>: <code>float</code> : Irrigaiton applied on current day mm</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="infiltration" class="doc_header"><code>infiltration</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L1204" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>infiltration</code>(<strong><code>prof</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>Infl</code></strong>, <strong><code>Irr</code></strong>, <strong><code>IrrMngt_AppEff</code></strong>, <strong><code>FieldMngt</code></strong>, <strong><code>FluxOut</code></strong>, <strong><code>DeepPerc0</code></strong>, <strong><code>Runoff0</code></strong>, <strong><code>GrowingSeason</code></strong>)</p>
</blockquote>
<p>Function to infiltrate incoming water (rainfall and irrigation)</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=51" target="_blank">Reference Manual: drainage calculations</a> (pg. 42-65)</p>
<p><em>Arguments:</em></p>
<p><code>prof</code>: <a href="/nbdev_qq_test/classes.html#SoilProfileClass"><code>SoilProfileClass</code></a> : Soil object containing soil paramaters</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>Infl</code>: <code>float</code> : Infiltration so far</p>
<p><code>Irr</code>: <code>float</code> : Irrigation on current day</p>
<p><code>IrrMngt_AppEff</code>: <code>float</code>: irrigation application efficiency</p>
<p><code>FieldMngt</code>: <a href="/nbdev_qq_test/classes.html#FieldMngtStruct"><code>FieldMngtStruct</code></a> : field management params</p>
<p><code>FluxOut</code>: <code>np.array</code> : flux of water out of each compartment</p>
<p><code>DeepPerc0</code>: <code>float</code> : initial Deep Percolation</p>
<p><code>Runoff0</code>: <code>float</code> : initial Surface Runoff</p>
<p><code>GrowingSeason</code>:: <code>bool</code> : is growing season (True or Flase)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>
<p><code>DeepPerc</code>:: <code>float</code> : Total Deep Percolation</p>
<p><code>RunoffTot</code>: <code>float</code> : Total surface Runoff</p>
<p><code>Infl</code>: <code>float</code> : Infiltration on current day</p>
<p><code>FluxOut</code>: <code>np.array</code> : flux of water out of each compartment</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="capillary_rise" class="doc_header"><code>capillary_rise</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L1482" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>capillary_rise</code>(<strong><code>prof</code></strong>, <strong><code>Soil_nLayer</code></strong>, <strong><code>Soil_fshape_cr</code></strong>, <strong><code>NewCond</code></strong>, <strong><code>FluxOut</code></strong>, <strong><code>ParamStruct_WaterTable</code></strong>)</p>
</blockquote>
<p>Function to calculate capillary rise from a shallow groundwater table</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=61" target="_blank">Reference Manual: capillary rise calculations</a> (pg. 52-61)</p>
<p><em>Arguments:</em></p>
<p><code>Soil</code>: <a href="/nbdev_qq_test/classes.html#SoilClass"><code>SoilClass</code></a> : Soil object</p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>FluxOut</code>: <code>np.array</code> : FLux of water out of each soil compartment</p>
<p><code>ParamStruct_WaterTable</code>: <code>int</code> : WaterTable present (1:yes, 0:no)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>
<p><code>CrTot</code>: <code>float</code> : Total Capillary rise</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="germination" class="doc_header"><code>germination</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L1668" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>germination</code>(<strong><code>InitCond</code></strong>, <strong><code>Soil_zGerm</code></strong>, <strong><code>prof</code></strong>, <strong><code>Crop_GermThr</code></strong>, <strong><code>Crop_PlantMethod</code></strong>, <strong><code>GDD</code></strong>, <strong><code>GrowingSeason</code></strong>)</p>
</blockquote>
<p>Function to check if crop has germinated</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=32" target="_blank">Reference Manual: germination condition</a> (pg. 23)</p>
<p><em>Arguments:</em></p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>Soil_zGerm</code>: <code>float</code> : Soil depth affecting germination</p>
<p><code>prof</code>: <a href="/nbdev_qq_test/classes.html#SoilProfileClass"><code>SoilProfileClass</code></a> : Soil object containing soil paramaters</p>
<p><code>Crop_GermThr</code>: <code>float</code> : Crop germination threshold</p>
<p><code>Crop_PlantMethod</code>: <code>bool</code> : sown as seedling True or False</p>
<p><code>GDD</code>: <code>float</code> : Number of Growing Degree Days on current day</p>
<p><code>GrowingSeason</code>:: <code>bool</code> : is growing season (True or Flase)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="growth_stage" class="doc_header"><code>growth_stage</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L1773" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>growth_stage</code>(<strong><code>Crop</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>GrowingSeason</code></strong>)</p>
</blockquote>
<p>Function to determine current growth stage of crop</p>
<p>(used only for irrigation soil moisture thresholds)</p>
<p><em>Arguments:</em></p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object containing Crop paramaters</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>GrowingSeason</code>:: <code>bool</code> : is growing season (True or Flase)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="water_stress" class="doc_header"><code>water_stress</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L1832" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>water_stress</code>(<strong><code>Crop</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>Dr</code></strong>, <strong><code>TAW</code></strong>, <strong><code>Et0</code></strong>, <strong><code>beta</code></strong>)</p>
</blockquote>
<p>Function to calculate water stress coefficients</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=18" target="_blank">Reference Manual: water stress equations</a> (pg. 9-13)</p>
<p><em>Arguments:</em></p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop Object</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object</p>
<p><code>Dr</code>: <a href="/nbdev_qq_test/classes.html#DrClass"><code>DrClass</code></a> : Depletion object (contains rootzone and top soil depletion totals)</p>
<p><code>TAW</code>: <a href="/nbdev_qq_test/classes.html#TAWClass"><code>TAWClass</code></a> : TAW object (contains rootzone and top soil total available water)</p>
<p><code>Et0</code>: <code>float</code> : Reference Evapotranspiration</p>
<p><code>beta</code>: <code>float</code> : Adjust senescence threshold if early sensescence is triggered</p>
<p><em>Returns:</em></p>
<p><code>Ksw</code>: <a href="/nbdev_qq_test/classes.html#KswClass"><code>KswClass</code></a> : Ksw object containint water stress coefficients</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cc_development" class="doc_header"><code>cc_development</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L1933" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cc_development</code>(<strong><code>CCo</code></strong>, <strong><code>CCx</code></strong>, <strong><code>CGC</code></strong>, <strong><code>CDC</code></strong>, <strong><code>dt</code></strong>, <strong><code>Mode</code></strong>, <strong><code>CCx0</code></strong>)</p>
</blockquote>
<p>Function to calculate canopy cover development by end of the current simulation day</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=30" target="_blank">Reference Manual: CC devlopment</a> (pg. 21-24)</p>
<p><em>Arguments:</em></p>
<p><code>CCo</code>: <code>float</code> : Fractional canopy cover size at emergence</p>
<p><code>CCx</code>: <code>float</code> : Maximum canopy cover (fraction of soil cover)</p>
<p><code>CGC</code>: <code>float</code> : Canopy growth coefficient (fraction per GDD)</p>
<p><code>CDC</code>: <code>float</code> : Canopy decline coefficient (fraction per GDD/calendar day)</p>
<p><code>dt</code>: <code>float</code> : Time delta of canopy growth (1 calander day or ... GDD)</p>
<p><code>Mode</code>: <code>str</code> : Stage of Canopy developement (Growth or Decline)</p>
<p><code>CCx0</code>: <code>float</code> : Maximum canopy cover (fraction of soil cover)</p>
<p><em>Returns:</em></p>
<p><code>CC</code>: <code>float</code> : Canopy Cover</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cc_required_time" class="doc_header"><code>cc_required_time</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L2003" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cc_required_time</code>(<strong><code>CCprev</code></strong>, <strong><code>CCo</code></strong>, <strong><code>CCx</code></strong>, <strong><code>CGC</code></strong>, <strong><code>CDC</code></strong>, <strong><code>Mode</code></strong>)</p>
</blockquote>
<p>Function to find time required to reach CC at end of previous day, given current CGC or CDC</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=30" target="_blank">Reference Manual: CC devlopment</a> (pg. 21-24)</p>
<p><em>Arguments:</em></p>
<p><code>CCprev</code>: <code>float</code> : Canopy Cover at previous timestep.</p>
<p><code>CCo</code>: <code>float</code> : Fractional canopy cover size at emergence</p>
<p><code>CCx</code>: <code>float</code> : Maximum canopy cover (fraction of soil cover)</p>
<p><code>CGC</code>: <code>float</code> : Canopy growth coefficient (fraction per GDD)</p>
<p><code>CDC</code>: <code>float</code> : Canopy decline coefficient (fraction per GDD/calendar day)</p>
<p><code>Mode</code>: <code>str</code> : Canopy growth/decline coefficient (fraction per GDD/calendar day)</p>
<p><em>Returns:</em></p>
<p><code>tReq</code>: <code>float</code> : time required to reach CC at end of previous day</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="adjust_CCx" class="doc_header"><code>adjust_CCx</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L2060" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>adjust_CCx</code>(<strong><code>CCprev</code></strong>, <strong><code>CCo</code></strong>, <strong><code>CCx</code></strong>, <strong><code>CGC</code></strong>, <strong><code>CDC</code></strong>, <strong><code>dt</code></strong>, <strong><code>tSum</code></strong>, <strong><code>Crop_CanopyDevEnd</code></strong>, <strong><code>Crop_CCx</code></strong>)</p>
</blockquote>
<p>Function to adjust CCx value for changes in CGC due to water stress during the growing season</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=36" target="_blank">Reference Manual: CC stress response</a> (pg. 27-33)</p>
<p><em>Arguments:</em></p>
<p><code>CCprev</code>: <code>float</code> : Canopy Cover at previous timestep.</p>
<p><code>CCo</code>: <code>float</code> : Fractional canopy cover size at emergence</p>
<p><code>CCx</code>: <code>float</code> : Maximum canopy cover (fraction of soil cover)</p>
<p><code>CGC</code>: <code>float</code> : Canopy growth coefficient (fraction per GDD)</p>
<p><code>CDC</code>: <code>float</code> : Canopy decline coefficient (fraction per GDD/calendar day)</p>
<p><code>dt</code>: <code>float</code> : Time delta of canopy growth (1 calander day or ... GDD)</p>
<p><code>tSum</code>: <code>float</code> : time since germination (CD or GDD)</p>
<p><code>Crop_CanopyDevEnd</code>: <code>float</code> : time that Canopy developement ends</p>
<p><code>Crop_CCx</code>: <code>float</code> : Maximum canopy cover (fraction of soil cover)</p>
<p><em>Returns:</em></p>
<p><code>CCxAdj</code>: <code>float</code> : Adjusted CCx</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="update_CCx_CDC" class="doc_header"><code>update_CCx_CDC</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L2114" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>update_CCx_CDC</code>(<strong><code>CCprev</code></strong>, <strong><code>CDC</code></strong>, <strong><code>CCx</code></strong>, <strong><code>dt</code></strong>)</p>
</blockquote>
<p>Function to update CCx and CDC parameter valyes for rewatering in late season of an early declining canopy</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=36" target="_blank">Reference Manual: CC stress response</a> (pg. 27-33)</p>
<p><em>Arguments:</em></p>
<p><code>CCprev</code>: <code>float</code> : Canopy Cover at previous timestep.</p>
<p><code>CDC</code>: <code>float</code> : Canopy decline coefficient (fraction per GDD/calendar day)</p>
<p><code>CCx</code>: <code>float</code> : Maximum canopy cover (fraction of soil cover)</p>
<p><code>dt</code>: <code>float</code> : Time delta of canopy growth (1 calander day or ... GDD)</p>
<p><em>Returns:</em></p>
<p><code>CCxAdj</code>: <code>float</code> : updated CCxAdj</p>
<p><code>CDCadj</code>: <code>float</code> : updated CDCadj</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="canopy_cover" class="doc_header"><code>canopy_cover</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L2156" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>canopy_cover</code>(<strong><code>Crop</code></strong>, <strong><code>Soil_Profile</code></strong>, <strong><code>Soil_zTop</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>GDD</code></strong>, <strong><code>Et0</code></strong>, <strong><code>GrowingSeason</code></strong>)</p>
</blockquote>
<p>Function to simulate canopy growth/decline</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=30" target="_blank">Reference Manual: CC equations</a> (pg. 21-33)</p>
<p><em>Arguments:</em></p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object</p>
<p><code>Soil_Profile</code>: <a href="/nbdev_qq_test/classes.html#SoilProfileClass"><code>SoilProfileClass</code></a> : Soil object</p>
<p><code>Soil_zTop</code>: <code>float</code> : top soil depth</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object</p>
<p><code>GDD</code>: <code>float</code> : Growing Degree Days</p>
<p><code>Et0</code>: <code>float</code> : reference evapotranspiration</p>
<p><code>GrowingSeason</code>:: <code>bool</code> : is it currently within the growing season (True, Flase)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : updated InitCond object</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evap_layer_water_content" class="doc_header"><code>evap_layer_water_content</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L2530" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evap_layer_water_content</code>(<strong><code>InitCond_th</code></strong>, <strong><code>InitCond_EvapZ</code></strong>, <strong><code>prof</code></strong>)</p>
</blockquote>
<p>Function to get water contents in the evaporation layer</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=82" target="_blank">Reference Manual: evaporation equations</a> (pg. 73-81)</p>
<p><em>Arguments:</em></p>
<p><code>InitCond_th</code>: <code>np.array</code> : Initial water content</p>
<p><code>InitCond_EvapZ</code>: <code>float</code> : evaporation depth</p>
<p><code>prof</code>: <a href="/nbdev_qq_test/classes.html#SoilProfileClass"><code>SoilProfileClass</code></a> : Soil object containing soil paramaters</p>
<p><em>Returns:</em></p>
<p><code>Wevap_Sat</code>: <code>float</code> : Water storage in evaporation layer at saturation (mm)</p>
<p><code>Wevap_Fc</code>: <code>float</code> : Water storage in evaporation layer at field capacity (mm)</p>
<p><code>Wevap_Wp</code>: <code>float</code> : Water storage in evaporation layer at permanent wilting point (mm)</p>
<p><code>Wevap_Dry</code>: <code>float</code> : Water storage in evaporation layer at air dry (mm)</p>
<p><code>Wevap_Act</code>: <code>float</code> : Actual water storage in evaporation layer (mm)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="soil_evaporation" class="doc_header"><code>soil_evaporation</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L2605" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>soil_evaporation</code>(<strong><code>ClockStruct_EvapTimeSteps</code></strong>, <strong><code>ClockStruct_SimOffSeason</code></strong>, <strong><code>ClockStruct_TimeStepCounter</code></strong>, <strong><code>Soil_EvapZmin</code></strong>, <strong><code>Soil_EvapZmax</code></strong>, <strong><code>Soil_Profile</code></strong>, <strong><code>Soil_REW</code></strong>, <strong><code>Soil_Kex</code></strong>, <strong><code>Soil_fwcc</code></strong>, <strong><code>Soil_fWrelExp</code></strong>, <strong><code>Soil_fevap</code></strong>, <strong><code>Crop_CalendarType</code></strong>, <strong><code>Crop_Senescence</code></strong>, <strong><code>IrrMngt_IrrMethod</code></strong>, <strong><code>IrrMngt_WetSurf</code></strong>, <strong><code>FieldMngt</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>Et0</code></strong>, <strong><code>Infl</code></strong>, <strong><code>Rain</code></strong>, <strong><code>Irr</code></strong>, <strong><code>GrowingSeason</code></strong>)</p>
</blockquote>
<p>Function to calculate daily soil evaporation</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=82" target="_blank">Reference Manual: evaporation equations</a> (pg. 73-81)</p>
<p><em>Arguments:</em></p>
<p><code>Clock params</code>: <code>bool, int</code> : clock params</p>
<p><code>Soil parameters</code>: <code>float</code> : soil parameters</p>
<p><code>Crop params</code>: <code>float</code> : Crop paramaters</p>
<p><code>IrrMngt params</code>: <code>int, float</code>: irrigation management paramaters</p>
<p><code>FieldMngt</code>: <a href="/nbdev_qq_test/classes.html#FieldMngtStruct"><code>FieldMngtStruct</code></a> : Field management paramaters</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>Et0</code>: <code>float</code> : daily reference evapotranspiration</p>
<p><code>Infl</code>: <code>float</code> : Infiltration on current day</p>
<p><code>Rain</code>: <code>float</code> : daily precipitation mm</p>
<p><code>Irr</code>: <code>float</code> : Irrigation applied on current day</p>
<p><code>GrowingSeason</code>:: <code>bool</code> : is growing season (True or Flase)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>
<p><code>EsAct</code>: <code>float</code> : Actual surface evaporation current day</p>
<p><code>EsPot</code>: <code>float</code> : Potential surface evaporation current day</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="aeration_stress" class="doc_header"><code>aeration_stress</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L2979" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>aeration_stress</code>(<strong><code>NewCond_AerDays</code></strong>, <strong><code>Crop_LagAer</code></strong>, <strong><code>thRZ</code></strong>)</p>
</blockquote>
<p>Function to calculate aeration stress coefficient</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=90" target="_blank">Reference Manual: aeration stress</a> (pg. 89-90)</p>
<p><em>Arguments:</em></p>
<p><code>NewCond_AerDays</code>: <code>int</code> : number aeration stress days</p>
<p><code>Crop_LagAer</code>: <code>int</code> : lag days before aeration stress</p>
<p><code>thRZ</code>: <a href="/nbdev_qq_test/classes.html#thRZClass"><code>thRZClass</code></a> : object that contains information on the total water in the root zone</p>
<p><em>Returns:</em></p>
<p><code>Ksa_Aer</code>: <code>float</code> : aeration stress coefficient</p>
<p><code>NewCond_AerDays</code>: <code>float</code> : updated aer days</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="transpiration" class="doc_header"><code>transpiration</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L3033" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>transpiration</code>(<strong><code>Soil_Profile</code></strong>, <strong><code>Soil_nComp</code></strong>, <strong><code>Soil_zTop</code></strong>, <strong><code>Crop</code></strong>, <strong><code>IrrMngt_IrrMethod</code></strong>, <strong><code>IrrMngt_NetIrrSMT</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>Et0</code></strong>, <strong><code>CO2</code></strong>, <strong><code>GrowingSeason</code></strong>, <strong><code>GDD</code></strong>)</p>
</blockquote>
<p>Function to calculate crop transpiration on current day</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=91" target="_blank">Reference Manual: transpiration equations</a> (pg. 82-91)</p>
<p><em>Arguments:</em></p>
<p><code>Soil</code>: <a href="/nbdev_qq_test/classes.html#SoilClass"><code>SoilClass</code></a> : Soil object</p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object</p>
<p><code>IrrMngt</code>: <code>IrrMngt</code>: object containing irrigation management params</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object</p>
<p><code>Et0</code>: <code>float</code> : reference evapotranspiration</p>
<p><code>CO2</code>: <code>CO2class</code> : CO2</p>
<p><code>GDD</code>: <code>float</code> : Growing Degree Days</p>
<p><code>GrowingSeason</code>:: <code>bool</code> : is it currently within the growing season (True, Flase)</p>
<p><em>Returns:</em></p>
<p><code>TrAct</code>: <code>float</code> : Actual Transpiration on current day</p>
<p><code>TrPot_NS</code>: <code>float</code> : Potential Transpiration on current day with no water stress</p>
<p><code>TrPot0</code>: <code>float</code> : Potential Transpiration on current day</p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : updated InitCond object</p>
<p><code>IrrNet</code>: <code>float</code> : Net Irrigation (if required)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="groundwater_inflow" class="doc_header"><code>groundwater_inflow</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L3496" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>groundwater_inflow</code>(<strong><code>prof</code></strong>, <strong><code>NewCond</code></strong>)</p>
</blockquote>
<p>Function to calculate capillary rise in the presence of a shallow groundwater table</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=61" target="_blank">Reference Manual: capillary rise calculations</a> (pg. 52-61)</p>
<p><em>Arguments:</em></p>
<p><code>Soil</code>: <a href="/nbdev_qq_test/classes.html#SoilClass"><code>SoilClass</code></a> : Soil object containing soil paramaters</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>
<p><code>GwIn</code>: <code>float</code> : Groundwater inflow</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HIref_current_day" class="doc_header"><code>HIref_current_day</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L3550" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HIref_current_day</code>(<strong><code>InitCond</code></strong>, <strong><code>Crop</code></strong>, <strong><code>GrowingSeason</code></strong>)</p>
</blockquote>
<p>Function to calculate reference (no adjustment for stress effects)
harvest index on current day</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=119" target="_blank">Reference Manual: harvest index calculations</a> (pg. 110-126)</p>
<p><em>Arguments:</em></p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object containing Crop paramaters</p>
<p><code>GrowingSeason</code>: <code>bool</code> : is growing season (True or Flase)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="biomass_accumulation" class="doc_header"><code>biomass_accumulation</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L3661" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>biomass_accumulation</code>(<strong><code>Crop</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>Tr</code></strong>, <strong><code>TrPot</code></strong>, <strong><code>Et0</code></strong>, <strong><code>GrowingSeason</code></strong>)</p>
</blockquote>
<p>Function to calculate biomass accumulation</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=107" target="_blank">Reference Manual: biomass accumulaiton</a> (pg. 98-108)</p>
<p><em>Arguments:</em></p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>Tr</code>: <code>float</code> : Daily transpiration</p>
<p><code>TrPot</code>: <code>float</code> : Daily potential transpiration</p>
<p><code>Et0</code>: <code>float</code> : Daily reference evapotranspiration</p>
<p><code>GrowingSeason</code>:: <code>bool</code> : is Growing season? (True, False)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="temperature_stress" class="doc_header"><code>temperature_stress</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L3750" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>temperature_stress</code>(<strong><code>Crop</code></strong>, <strong><code>Tmax</code></strong>, <strong><code>Tmin</code></strong>)</p>
</blockquote>
<p>Function to get irrigation depth for current day</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=23" target="_blank">Reference Manual: temperature stress</a> (pg. 14)</p>
<p><em>Arguments:</em></p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object containing Crop paramaters</p>
<p><code>Tmax</code>: <code>float</code> : max tempatature on current day (celcius)</p>
<p><code>Tmin</code>: <code>float</code> : min tempature on current day (celcius)</p>
<p><em>Returns:</em></p>
<p><code>Kst</code>: <a href="/nbdev_qq_test/classes.html#KstClass"><code>KstClass</code></a> : Kst object containing tempature stress paramators</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HIadj_pre_anthesis" class="doc_header"><code>HIadj_pre_anthesis</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L3828" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HIadj_pre_anthesis</code>(<strong><code>InitCond</code></strong>, <strong><code>Crop_dHI_pre</code></strong>)</p>
</blockquote>
<p>Function to calculate adjustment to harvest index for pre-anthesis water
stress</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=119" target="_blank">Reference Manual: harvest index calculations</a> (pg. 110-126)</p>
<p><em>Arguments:</em></p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object containing Crop paramaters</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HIadj_pollination" class="doc_header"><code>HIadj_pollination</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L3892" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HIadj_pollination</code>(<strong><code>InitCond_CC</code></strong>, <strong><code>InitCond_Fpol</code></strong>, <strong><code>Crop_FloweringCD</code></strong>, <strong><code>Crop_CCmin</code></strong>, <strong><code>Crop_exc</code></strong>, <strong><code>Ksw</code></strong>, <strong><code>Kst</code></strong>, <strong><code>HIt</code></strong>)</p>
</blockquote>
<p>Function to calculate adjustment to harvest index for failure of
pollination due to water or temperature stress</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=119" target="_blank">Reference Manual: harvest index calculations</a> (pg. 110-126)</p>
<p><em>Arguments:</em></p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object containing Crop paramaters</p>
<p><code>Ksw</code>: <a href="/nbdev_qq_test/classes.html#KswClass"><code>KswClass</code></a> : Ksw object containing water stress paramaters</p>
<p><code>Kst</code>: <a href="/nbdev_qq_test/classes.html#KstClass"><code>KstClass</code></a> : Kst object containing tempature stress paramaters</p>
<p><code>HIt</code>: <code>float</code> : time for harvest index build-up (calander days)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HIadj_post_anthesis" class="doc_header"><code>HIadj_post_anthesis</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L3989" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HIadj_post_anthesis</code>(<strong><code>InitCond</code></strong>, <strong><code>Crop</code></strong>, <strong><code>Ksw</code></strong>)</p>
</blockquote>
<p>Function to calculate adjustment to harvest index for post-anthesis water
stress</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=119" target="_blank">Reference Manual: harvest index calculations</a> (pg. 110-126)</p>
<p><em>Arguments:</em></p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object containing Crop paramaters</p>
<p><code>Ksw</code>: <a href="/nbdev_qq_test/classes.html#KswClass"><code>KswClass</code></a> : Ksw object containing water stress paramaters</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="harvest_index" class="doc_header"><code>harvest_index</code><a href="https://github.com/qiz5/nbdev_qq_test/tree/{branch}/nbdev_qq_test/solution.py#L4076" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>harvest_index</code>(<strong><code>Soil_Profile</code></strong>, <strong><code>Soil_zTop</code></strong>, <strong><code>Crop</code></strong>, <strong><code>InitCond</code></strong>, <strong><code>Et0</code></strong>, <strong><code>Tmax</code></strong>, <strong><code>Tmin</code></strong>, <strong><code>GrowingSeason</code></strong>)</p>
</blockquote>
<p>Function to simulate build up of harvest index</p>
<p><a href="../pdfs/ac_ref_man_3.pdf#page=119" target="_blank">Reference Manual: harvest index calculations</a> (pg. 110-126)</p>
<p><em>Arguments:</em></p>
<p><code>Soil</code>: <a href="/nbdev_qq_test/classes.html#SoilClass"><code>SoilClass</code></a> : Soil object containing soil paramaters</p>
<p><code>Crop</code>: <a href="/nbdev_qq_test/classes.html#CropClass"><code>CropClass</code></a> : Crop object containing Crop paramaters</p>
<p><code>InitCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing model paramaters</p>
<p><code>Et0</code>: <code>float</code> : reference evapotranspiration on current day</p>
<p><code>Tmax</code>: <code>float</code> : maximum tempature on current day (celcius)</p>
<p><code>Tmin</code>: <code>float</code> : minimum tempature on current day (celcius)</p>
<p><code>GrowingSeason</code>:: <code>bool</code> : is growing season (True or Flase)</p>
<p><em>Returns:</em></p>
<p><code>NewCond</code>: <a href="/nbdev_qq_test/classes.html#InitCondClass"><code>InitCondClass</code></a> : InitCond object containing updated model paramaters</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

